<h2 id="tableLabel">Список моделей вагонов</h2>

<div>
  <button mat-raised-button color="primary" (click)="add()">Добавить</button>
</div>

<div *ngIf="tableMode; else create">
  <mat-form-field>
    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Фильтр">
  </mat-form-field>

  <div class="mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" matSort>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Модель </th>
        <td mat-cell *matCellDef="let element">
          <a [routerLink]="[element._id.$oid]" class="nav-link">{{element.name}}</a>  
        </td>
      </ng-container>

      <ng-container matColumnDef="company">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Производитель </th>
        <td mat-cell *matCellDef="let element"> {{element.company}} </td>
      </ng-container>

      <ng-container matColumnDef="screenType">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Тип экрана </th>
        <td mat-cell *matCellDef="let element"> {{element.screenTypeName}} </td>
      </ng-container>

      <ng-container matColumnDef="os">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> OS </th>
        <td mat-cell *matCellDef="let element"> {{element.osName}} </td>
      </ng-container>

      <ng-container matColumnDef="deliveryDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Дата поставки </th>
        <td mat-cell *matCellDef="let element">
          {{element.deliveryDateText}}
        </td>
      </ng-container>

      <ng-container matColumnDef="isNfc">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> NFC </th>
        <td mat-cell *matCellDef="let element">
          <mat-icon aria-label="Example home icon">{{element.isNfcIcon}}</mat-icon>
        </td>
      </ng-container>

      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Цена </th>
        <td mat-cell *matCellDef="let element"> {{element.price}} </td>
      </ng-container>

      <ng-container matColumnDef="createdAt">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Дата создания </th>
        <td mat-cell *matCellDef="let element">
          {{element.createdAtText}}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="[10, 25, 100]"></mat-paginator>
  </div>
</div>


<!--шаблон для добавления-->
<ng-template #create>
  <br/>
  <form [formGroup]="vagon_form" (ngSubmit)="submit()">
  <mat-card class="vagon-card">
    <mat-card-header>
      <mat-card-title>Добавление модели</mat-card-title>
      <mat-card-subtitle>Введите характеристики вагона</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>

      <!-- <mat-grid-list cols="2" rowHeight="1:2" gutterSize="30px">
        <mat-grid-tile>
      <mat-card class="vagon-card1">
        <mat-card-content>
      <mat-form-field appearance="fill">
        <mat-label>Модель</mat-label>
        <input type="text" matInput [formControl]="model" required>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Принадлежность</mat-label>
        <input type="text" [formControl]="countryOwner" matInput required>
      </mat-form-field>
      
      

      <mat-form-field appearance="fill">
        <mat-label>Дата окончания аренды</mat-label>
        <input matInput [matDatepicker]="rentalEndDateControl" [min]="minDate" [max]="maxDate" [formControl]="rentalEndDate" required>
        <mat-datepicker-toggle matSuffix [for]="rentalEndDateControl"></mat-datepicker-toggle>
        <mat-datepicker #rentalEndDateControl></mat-datepicker>
      </mat-form-field>

      <mat-checkbox class="checkbox-margin" color="primary" [formControl]="isClosedFloor">Глуходонный</mat-checkbox>

      <mat-form-field appearance="fill">
        <mat-label>Грузоподъемность(т)</mat-label>
        <input matInput type="number" placeholder="Введите значение" [formControl]="capacityControl" min="0" required>
        <span matSuffix>&nbsp; т</span>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Тара(т)</mat-label>
        <input matInput type="number" placeholder="Введите значение" [formControl]="tareControl" min="0" required>
        <span matSuffix>&nbsp;т</span>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Тип собственности</mat-label>
        <mat-select [formControl]="ownType" name="ownType" required>
          <mat-option *ngFor="let ownType of vagon.ownTypeList" [value]="ownType.value">
            {{ownType.viewValue}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Кол-во осей</mat-label>
        <input matInput type="number" placeholder="Введите значение" [formControl]="axlesCountControl" min="0" required>
        <span matSuffix>&nbsp;шт</span>
      </mat-form-field>

      <label id="vagon-type-label">Тип вагона:</label>
      <mat-radio-group
        aria-labelledby="vagon-type-label"
        class="vagon-type-radio-group"
        [formControl]="vagonType">
        <mat-radio-button class="vagon-type-radio-button" *ngFor="let vagonType of vagon.vagonTypeList" [value]="vagonType.value">
          {{vagonType.viewValue}}
        </mat-radio-button>
      </mat-radio-group>
      </mat-card-content>
      </mat-card>
      </mat-grid-tile>

        <mat-grid-tile>

          <mat-card class="vagon-card1">
          <mat-card-content>

            <mat-form-field appearance="fill">
              <mat-label>Объем кузова(м3)</mat-label>
              <input matInput type="number" placeholder="Введите значение" [formControl]="volumeControl" min="0" required>
              <span matSuffix>&nbsp;м3</span>
            </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Длина(м)</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="lengthControl" min="0" required>
            <span matSuffix>&nbsp;м</span>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Собственник</mat-label>
            <input type="text" matInput [formControl]="ownerName" required>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Арендатор</mat-label>
            <input type="text" matInput [formControl]="tenantName">
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Оператор</mat-label>
            <input type="text" matInput [formControl]="operatorName">
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Пробег(км)</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="mileageControl" min="0" required>
            <span matSuffix>&nbsp;км</span>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Год выпуска</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="productionYearControl" min="0" required>
            <span matSuffix>&nbsp;год</span>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Дата последнего ремонта</mat-label>
            <input matInput [matDatepicker]="lastRepairDateControl" [min]="minDate" [max]="maxDate" [formControl]="lastRepairDate" required>
            <mat-datepicker-toggle matSuffix [for]="lastRepairDateControl"></mat-datepicker-toggle>
            <mat-datepicker #lastRepairDateControl></mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Дата следующего ремонта</mat-label>
            <input matInput [matDatepicker]="nextRepairDateControl" [min]="minDate" [max]="maxDate" [formControl]="nextRepairDate" required>
            <mat-datepicker-toggle matSuffix [for]="nextRepairDateControl"></mat-datepicker-toggle>
            <mat-datepicker #nextRepairDateControl></mat-datepicker>
          </mat-form-field>
          
          <mat-form-field appearance="fill">
            <mat-label>Ссылка на изображение</mat-label>
            <input type="text" matInput [formControl]="imgUrl">
          </mat-form-field>
          </mat-card-content>
          </mat-card>
        </mat-grid-tile>
      </mat-grid-list> -->

      <mat-grid-list cols="2" rowHeight="60px" gutterSize="15px">
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Модель</mat-label>
            <input type="text" matInput [formControl]="model" required>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Принадлежность</mat-label>
            <input type="text" [formControl]="countryOwner" matInput required>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Дата окончания аренды</mat-label>
            <input matInput [matDatepicker]="rentalEndDateControl" [min]="minDate" [max]="maxDate" [formControl]="rentalEndDate" required>
            <mat-datepicker-toggle matSuffix [for]="rentalEndDateControl"></mat-datepicker-toggle>
            <mat-datepicker #rentalEndDateControl></mat-datepicker>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-checkbox class="checkbox-margin" color="primary" [formControl]="isClosedFloor">Глуходонный</mat-checkbox>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Грузоподъемность(т)</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="capacityControl" min="0" required>
            <span matSuffix>&nbsp; т</span>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Тара(т)</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="tareControl" min="0" required>
            <span matSuffix>&nbsp;т</span>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Тип собственности</mat-label>
            <mat-select [formControl]="ownType" name="ownType" required>
              <mat-option *ngFor="let ownType of vagon.ownTypeList" [value]="ownType.value">
                {{ownType.viewValue}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Кол-во осей</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="axlesCountControl" min="0" required>
            <span matSuffix>&nbsp;шт</span>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Объем кузова(м3)</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="volumeControl" min="0" required>
            <span matSuffix>&nbsp;м3</span>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Длина(м)</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="lengthControl" min="0" required>
            <span matSuffix>&nbsp;м</span>
          </mat-form-field>    
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Собственник</mat-label>
            <input type="text" matInput [formControl]="ownerName" required>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Арендатор</mat-label>
            <input type="text" matInput [formControl]="tenantName">
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Оператор</mat-label>
            <input type="text" matInput [formControl]="operatorName">
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Пробег(км)</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="mileageControl" min="0" required>
            <span matSuffix>&nbsp;км</span>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Год выпуска</mat-label>
            <input matInput type="number" placeholder="Введите значение" [formControl]="productionYearControl" min="0" required>
            <span matSuffix>&nbsp;год</span>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Дата последнего ремонта</mat-label>
            <input matInput [matDatepicker]="lastRepairDateControl" [min]="minDate" [max]="maxDate" [formControl]="lastRepairDate" required>
            <mat-datepicker-toggle matSuffix [for]="lastRepairDateControl"></mat-datepicker-toggle>
            <mat-datepicker #lastRepairDateControl></mat-datepicker>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Дата следующего ремонта</mat-label>
            <input matInput [matDatepicker]="nextRepairDateControl" [min]="minDate" [max]="maxDate" [formControl]="nextRepairDate" required>
            <mat-datepicker-toggle matSuffix [for]="nextRepairDateControl"></mat-datepicker-toggle>
            <mat-datepicker #nextRepairDateControl></mat-datepicker>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Ссылка на изображение</mat-label>
            <input type="text" matInput [formControl]="imgUrl">
          </mat-form-field>
        </mat-grid-tile>
      </mat-grid-list>
      <div class="vagon-type">
        <label id="vagon-type-label">Тип вагона:</label>
        <mat-radio-group
          aria-labelledby="vagon-type-label"
          class="vagon-type-radio-group"
          [formControl]="vagonType">
          <mat-radio-button class="vagon-type-radio-button" *ngFor="let vagonType of vagon.vagonTypeList" [value]="vagonType.value">
            {{vagonType.viewValue}}
          </mat-radio-button>
        </mat-radio-group>
      </div>

    </mat-card-content>
    
    <mat-card-actions>
      <div class="mat-card-actions-div">
          <button mat-stroked-button color="primary" [disabled]="vagon_form.invalid">Сохранить</button>
          <button mat-stroked-button (click)="cancel()">Отмена</button>
      </div>
    </mat-card-actions>
  
</mat-card>
</form>
</ng-template>